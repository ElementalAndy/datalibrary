language: cpp
compiler:
  - gcc
  - clang

global:
  - secure: "bTly315GwxokKDf+13sg/BRQffijK9CUVHA3SilDTe83Eow7s7n4VBLNoy2EY5s/gTC2un3ItQRR+m8CWaONa24InTolnfUe2jgbpddaBTNm1FTKX/GnEdOWjHjtDmWEu0mi1W9kOsngjhhdSy4+44ZW2jH+pW2pQ7LhqyV41XM="

before_install:
  - sudo apt-get update -qq
  - sudo apt-get install -qq libc6-dev-i386 g++-multilib

install:
  - git clone https://github.com/matricks/bam.git
  - cd bam
  - ./make_unix.sh
  - cd ..

script:
  - bam/bam compiler=$CC platform=linux_x86 config=debug -r sc test
  - bam/bam compiler=$CC platform=linux_x86 config=release -r sc test
  - bam/bam compiler=$CC platform=linux_x86_64 config=debug -r sc test
  - bam/bam compiler=$CC platform=linux_x86_64 config=release -r sc test

addons:
  coverity_scan:
    project:
      name: "wc-duck/datalibrary"
      description: "Build submitted via Travis CI"
    notification_email: fredrik.kihlander@gmail.com
    build_command_prepend: "bam/bam compiler=$CC platform=linux_x86_64 config=debug -r sc -c"
    build_command:   "bam/bam compiler=$CC platform=linux_x86_64 config=debug -r sc"
    branch_pattern: coverity_scan

